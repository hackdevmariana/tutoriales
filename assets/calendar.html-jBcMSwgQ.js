import{_ as n,o as s,c as a,d as t}from"./app-DFX1n3rW.js";const e={},p=t(`<h1 id="trabajar-con-google-calendar-desde-google-colab" tabindex="-1"><a class="header-anchor" href="#trabajar-con-google-calendar-desde-google-colab"><span>Trabajar con Google Calendar desde Google Colab</span></a></h1><p>Primero, necesitaresmo instalar las bibliotecas necesarias en Google Colab:</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>!pip install <span class="token operator">-</span><span class="token operator">-</span>upgrade google<span class="token operator">-</span>api<span class="token operator">-</span>python<span class="token operator">-</span>client google<span class="token operator">-</span>auth<span class="token operator">-</span>httplib2 google<span class="token operator">-</span>auth<span class="token operator">-</span>oauthlib
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Autentica y acceder a Google Calendar para mostrar los próximos eventos:</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code><span class="token keyword">from</span> google<span class="token punctuation">.</span>colab <span class="token keyword">import</span> auth
<span class="token keyword">from</span> googleapiclient<span class="token punctuation">.</span>discovery <span class="token keyword">import</span> build
<span class="token keyword">from</span> google_auth_oauthlib<span class="token punctuation">.</span>flow <span class="token keyword">import</span> InstalledAppFlow
<span class="token keyword">from</span> google<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>transport<span class="token punctuation">.</span>requests <span class="token keyword">import</span> Request
<span class="token keyword">import</span> pickle
<span class="token keyword">import</span> os

<span class="token comment"># Autenticación</span>
auth<span class="token punctuation">.</span>authenticate_user<span class="token punctuation">(</span><span class="token punctuation">)</span>

SCOPES <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;https://www.googleapis.com/auth/calendar.readonly&#39;</span><span class="token punctuation">]</span>
creds <span class="token operator">=</span> <span class="token boolean">None</span>

<span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">&#39;token.pickle&#39;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&#39;token.pickle&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;rb&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> token<span class="token punctuation">:</span>
  creds <span class="token operator">=</span> pickle<span class="token punctuation">.</span>load<span class="token punctuation">(</span>token<span class="token punctuation">)</span>

<span class="token keyword">if</span> <span class="token keyword">not</span> creds <span class="token keyword">or</span> <span class="token keyword">not</span> creds<span class="token punctuation">.</span>valid<span class="token punctuation">:</span>
  <span class="token keyword">if</span> creds <span class="token keyword">and</span> creds<span class="token punctuation">.</span>expired <span class="token keyword">and</span> creds<span class="token punctuation">.</span>refresh_token<span class="token punctuation">:</span>
    creds<span class="token punctuation">.</span>refresh<span class="token punctuation">(</span>Request<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">else</span><span class="token punctuation">:</span>
    flow <span class="token operator">=</span> InstalledAppFlow<span class="token punctuation">.</span>from_client_secrets_file<span class="token punctuation">(</span>
    <span class="token string">&#39;credentials.json&#39;</span><span class="token punctuation">,</span> SCOPES<span class="token punctuation">)</span>
  creds <span class="token operator">=</span> flow<span class="token punctuation">.</span>run_local_server<span class="token punctuation">(</span>port<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&#39;token.pickle&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;wb&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> token<span class="token punctuation">:</span>
  pickle<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>creds<span class="token punctuation">,</span> token<span class="token punctuation">)</span>

  service <span class="token operator">=</span> build<span class="token punctuation">(</span><span class="token string">&#39;calendar&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;v3&#39;</span><span class="token punctuation">,</span> credentials<span class="token operator">=</span>creds<span class="token punctuation">)</span>

  <span class="token comment"># Llamada a la API de Google Calendar</span>
  events_result <span class="token operator">=</span> service<span class="token punctuation">.</span>events<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">list</span><span class="token punctuation">(</span>calendarId<span class="token operator">=</span><span class="token string">&#39;primary&#39;</span><span class="token punctuation">,</span> maxResults<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> singleEvents<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> orderBy<span class="token operator">=</span><span class="token string">&#39;startTime&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token punctuation">)</span>
  events <span class="token operator">=</span> events_result<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;items&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

  <span class="token keyword">if</span> <span class="token keyword">not</span> events<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;No upcoming events found.&#39;</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span> event <span class="token keyword">in</span> events<span class="token punctuation">:</span>
    start <span class="token operator">=</span> event<span class="token punctuation">[</span><span class="token string">&#39;start&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;dateTime&#39;</span><span class="token punctuation">,</span> event<span class="token punctuation">[</span><span class="token string">&#39;start&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> event<span class="token punctuation">[</span><span class="token string">&#39;summary&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,5),o=[p];function c(l,i){return s(),a("div",null,o)}const r=n(e,[["render",c],["__file","calendar.html.vue"]]),k=JSON.parse('{"path":"/colab/calendar.html","title":"Trabajar con Google Calendar desde Google Colab","lang":"en-US","frontmatter":{},"headers":[],"git":{"updatedTime":null,"contributors":[]},"filePathRelative":"colab/calendar.md"}');export{r as comp,k as data};
